Layer 2: Offline Transaction Protocol
Transactions occur via proximity communication without internet:

Communication Methods:

NFC (Near Field Communication): 1-2 meter range, 424 kbps

Bluetooth Low Energy: 10-100 meter range, 1 Mbps

QR Code: Visual scanning, asymmetric (payer to payee)

Transaction Message Structure:

json
{
  "version": "1.0",
  "device_id": "did:hedera:mainnet:zAbC123...",
  "sequence_number": 42,
  "nonce": "7f9a3b2c1d...",
  "timestamp": 1700000000,
  "amount": 500,
  "currency": "INR",
  "recipient_id": "did:hedera:mainnet:xYz789...",
  "signature": "3045022100...",
  "balance_certificate_hash": "sha256:1a2b3c..."
}
Double-Spend Prevention (Multi-Layer):

Layer 2A: Hardware Sequence + Nonce

Each transaction assigned monotonically increasing sequence number

Unique cryptographic nonce generated per transaction

Recipient device maintains local database of received nonces

IF duplicate nonce detected → AUTO-REJECT (suspected double-spend)

IF sequence number violates ordering → AUTO-REJECT

Layer 2B: Local Mesh Consensus (Optional)

Devices within proximity (e.g., 100m radius) form temporary mesh network

Byzantine Fault Tolerance (BFT) consensus algorithm

Conflicting transactions (same payer, overlapping time) require 2/3 node agreement

Suspicious patterns flagged for reconciliation

Layer 2C: Offline Spending Limits

Balance certificate encodes maximum offline transaction value

Secure element enforces limit without server query

Example: ₹5,000 per transaction, ₹20,000 daily cumulative

Certificate expiry (e.g., 72 hours) forces periodic online sync

Key Claim: Multi-layered fraud prevention achieves security equivalent to online systems without requiring network connectivity.

Layer 3: Distributed Ledger Settlement
When devices reconnect to network (WiFi, cellular), automatic reconciliation occurs:

Settlement Protocol:

text
1. Device detects network connectivity
2. Background service triggers automatic sync
3. All pending transactions batched into single submission
4. Transactions submitted to distributed ledger consensus service
   (e.g., Hedera Consensus Service, Hashgraph algorithm)
5. Consensus nodes validate:
   - Transaction signatures
   - Balance certificate authenticity
   - Nonce uniqueness (global check)
   - Timestamp sequencing
   - No conflicting transactions
6. IF valid: Record transaction on immutable ledger
7. Settlement finality achieved in 3-5 seconds
8. Balance certificates updated by issuing authority
9. Devices receive updated certificates
10. Process repeats for next offline period
Distributed Ledger Properties:

Consensus Algorithm: Asynchronous Byzantine Fault Tolerance (aBFT)

Mathematically proven fairness and finality

10,000+ transactions per second capacity

3-5 second finality (vs. 10-60 minutes for traditional blockchains)

Immutable Audit Trail: All transactions permanently recorded with:

Cryptographic hashes

Consensus timestamps

Multi-signature validation proofs

Regulatory audit logs

Scalability: Parallel topic architecture supports national-scale deployment

50,000 TPS capacity with 5 parallel topics

Sub-₹0.01 transaction cost

99.999% uptime (proven production metrics)

Key Claim: Distributed ledger settlement provides instant finality upon reconnection while maintaining full audit trail for regulatory compliance.